-- 增加横向权限
UPDATE `grid_basic_config` SET `id`='teacherEvaluateInfoAnalyse', `title`='教师评价统计', `can_search`='1', `can_add`=NULL, `can_delete`=NULL, `can_update`=NULL, `can_batch_add`=NULL, `can_projections`='0', `first_search`='0', `entity_class`='com.whaty.domain.bean.PeTeacher', `note`=NULL, `list_type`='1', `dc`=NULL, `flag_active`='4028809c1d625bcf011d66fd0dda0006', `flag_bak`=NULL, `dateFormat`=NULL, `sqlstr`='SELECT\n	tea.id AS id,\n	unit. NAME AS unitName,\n	tea.true_name AS teaName,\n	tea.login_id AS loginId,\n	count(DISTINCT stu.id) AS stuCount,\n	COUNT(DISTINCT cct.id) AS teachCount,\n	cct.training_date AS teachDate\nFROM\n	pe_teacher tea\nINNER JOIN pe_unit unit ON unit.id = tea.fk_unit_id AND [peUnit|unit.id]\nINNER JOIN pe_course c ON tea.id = c.fk_teacher_id\nINNER JOIN class_course cc ON cc.fk_course_id = c.id\nINNER JOIN pe_class cl ON cl.id = cc.fk_class_id\nINNER JOIN class_course_timetable cct ON cct.fk_class_course_id = cc.id\nINNER JOIN course_time ct ON cct.fk_course_time_id = ct.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_student stu ON stu.fk_class_id = cl.id\nwhere tea.site_code = \'${siteCode}\'\nGROUP BY tea.id', `statistics`=NULL, `s_note`=NULL, `update_note`=NULL, `is_enum`=NULL, `countsql`=NULL, `isGroupSql`=NULL, `LIST_FUNCTION`='0', `FLAG_INTE_ACTIVE`=NULL, `fk_web_site_id`='4028ae316a09ee85016a09f4d7640000', `can_checked_all`='0', `add_mode`='dialog', `add_cmp_name`=NULL, `fk_chart_id`=NULL WHERE (`id`='teacherEvaluateInfoAnalyse');
UPDATE `grid_basic_config` SET `id`='classMasterEvaluateAnalyse', `title`='班主任带班统计', `can_search`='1', `can_add`=NULL, `can_delete`=NULL, `can_update`=NULL, `can_batch_add`=NULL, `can_projections`='0', `first_search`='0', `entity_class`='com.whaty.domain.bean.evaluate.OverallEvaluateOption', `note`=NULL, `list_type`='1', `dc`=NULL, `flag_active`='4028809c1d625bcf011d66fd0dda0006', `flag_bak`=NULL, `dateFormat`=NULL, `sqlstr`='SELECT\n	tea.id as id,\n	cl.name as clName,\n  cl.code as clCode,\n  cl.start_time as startTime,\n  cl.end_time as endTime,\n	unit. NAME AS unitName,\n	tea.true_name AS teaName,\n	tea.login_id AS loginId,\n	count(DISTINCT cl.id) AS clCount,\n	count(DISTINCT stu.id) AS stuCount,\n	count(DISTINCT wu.id) AS wuCount,\n  COUNT(if(ao.code=\'0\',1,null)) as dCount,\n  concat(round(COUNT(if(ao.code=\'0\',1,null))/COUNT(stu.id)*100,2),\'%\') as dRate,\n  COUNT(if(ao.code=\'1\',1,null)) as cCount,\n  concat(round(COUNT(if(ao.code=\'1\',1,null))/COUNT(stu.id)*100,2),\'%\') as cRate,\n  COUNT(if(ao.code=\'2\',1,null)) as bCount,\n  concat(round(COUNT(if(ao.code=\'2\',1,null))/COUNT(stu.id)*100,2),\'%\') as bRate,\n  COUNT(if(ao.code=\'3\',1,null)) as aCount,\n  concat(round(COUNT(if(ao.code=\'3\',1,null))/COUNT(stu.id)*100,2),\'%\') as aRate,\n  COUNT(if(ao.code is null,1,null)) as absendCount,\n  concat(round(COUNT(if(ao.code is null,1,null))/COUNT(stu.id)*100,2),\'%\') as absendRate\nFROM\n	pe_teacher tea\nINNER JOIN pe_unit unit ON unit.id = tea.fk_unit_id AND [peUnit|unit.id]\nINNER JOIN pe_class cl on cl.fk_class_master_id=tea.id\nINNER JOIN pe_student stu ON stu.fk_class_id = cl.id\nINNER JOIN enum_const qt on qt.NAMESPACE=\'flagQuestionType\' AND qt.code=\'1\'\nINNER JOIN enum_const va on va.namespace=\'flagIsvalid\' AND va.code=\'1\'\nINNER JOIN overall_evaluate oe ON oe.flag_isvalid=va.id\nINNER JOIN overall_evaluate_option oeo on oeo.fk_evaluate_id=oe.id\nAND oeo.flag_question_type=qt.id\nINNER JOIN enum_const ot on ot.id=oeo.flag_option_type\nand ot.code=\'2\'\nLEFT JOIN wechat_user wu on wu.fk_sso_user_id=stu.fk_sso_user_id\nLEFT JOIN	overall_evaluate_answer oea on oea.fk_sso_user_id=stu.fk_sso_user_id\nAND oea.fk_option_id=oeo.id\nLEFT join enum_const ao on ao.id=oea.answer\nwhere tea.site_code = \'${siteCode}\'\nGROUP BY tea.id', `statistics`=NULL, `s_note`=NULL, `update_note`=NULL, `is_enum`=NULL, `countsql`=NULL, `isGroupSql`=NULL, `LIST_FUNCTION`='0', `FLAG_INTE_ACTIVE`=NULL, `fk_web_site_id`='4028ae316a09ee85016a09f4d7640000', `can_checked_all`='0', `add_mode`=NULL, `add_cmp_name`=NULL, `fk_chart_id`=NULL WHERE (`id`='classMasterEvaluateAnalyse');
UPDATE `grid_basic_config` SET `id`='onlineExamScoreAnalyse', `title`='考试成绩统计', `can_search`='1', `can_add`=NULL, `can_delete`=NULL, `can_update`=NULL, `can_batch_add`=NULL, `can_projections`='0', `first_search`='0', `entity_class`='com.whaty.domain.bean.StudentOnlineExamScore', `note`=NULL, `list_type`='1', `dc`='StudentOnlineExamScore;\nclassOnlineExam,[peCourse];\npeStudent,[peClass;[trainingItem;[enumConstByFlagTrainingType]]];\nenumConstByFlagScorePublish;', `flag_active`='4028809c1d625bcf011d66fd0dda0006', `flag_bak`=NULL, `dateFormat`=NULL, `sqlstr`='SELECT\n  ifnull(sc.id,md5(concat(stu.id,exam.id))) as id,\n  unit.name as unitName,\n  tt.name as trainingType,\n  cl.name as className,\n  cl.code as classCode,\n  cou.name as courseName,\n  exam.paper_no as paperNo,\n  count(stu.id) as stuCount,\n  count(sc.id) as scCount,\n  count(stu.id)-COUNT(sc.id) as notScCount,\n  concat(ROUND(COUNT(sc.id is null)/count(stu.id)*100),\'%\') as abRate,\n  concat(ROUND(COUNT(sc.score<60)/count(stu.id)*100),\'%\') as notPassRate,\n  concat(ROUND(COUNT(sc.score>=60)/count(stu.id)*100),\'%\') as passRate\nFROM\nclass_online_exam exam\nINNER JOIN pe_class cl on cl.id=exam.fk_class_id and cl.site_code = \'${siteCode}\'\nINNER JOIN pe_unit unit on unit.id=cl.fk_unit_id AND [peUnit|unit.id]\nINNER JOIN training_item item on item.id=cl.fk_training_item_id\nINNER JOIN enum_const tt on tt.id=item.flag_training_type\nINNER JOIN pe_student stu ON stu.fk_class_id = exam.fk_class_id\nLEFT JOIN pe_course cou on cou.id=exam.fk_course_id\nLEFT JOIN	student_online_exam_score sc on exam.id=sc.fk_class_online_exam_id\nLEFT JOIN enum_const pub on pub.id=sc.flag_score_publish\nGROUP BY exam.id', `statistics`=NULL, `s_note`=NULL, `update_note`=NULL, `is_enum`=NULL, `countsql`=NULL, `isGroupSql`=NULL, `LIST_FUNCTION`='0', `FLAG_INTE_ACTIVE`=NULL, `fk_web_site_id`='4028ae316a09ee85016a09f4d7640000', `can_checked_all`='1', `add_mode`=NULL, `add_cmp_name`=NULL, `fk_chart_id`=NULL WHERE (`id`='onlineExamScoreAnalyse');
-- 访问url更新
UPDATE `pe_interface` SET `url`='/entity/information/userAddressBook/**' WHERE (`name`='用户通讯录管理');
UPDATE `pe_base_category` SET `url`='/entity/information/userAddressBook/abstractGrid' WHERE (`name`='用户通讯录管理');