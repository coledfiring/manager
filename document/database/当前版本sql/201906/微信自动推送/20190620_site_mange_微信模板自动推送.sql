SET FOREIGN_KEY_CHECKS=0;

DROP TABLE IF EXISTS `wechat_template_time`;
CREATE TABLE `wechat_template_time` (
  `id` varchar(32) NOT NULL,
  `name` varchar(50) NOT NULL COMMENT '名称',
  `fk_wechat_template_site_id` int(9) NOT NULL COMMENT '微信模板消息站点',
  `data_sql` text NOT NULL COMMENT '查询数据的sql',
  `early_days` varchar(255) NOT NULL COMMENT '提前的天数，'',''分割',
  `note` varchar(255) DEFAULT NULL COMMENT '说明',
  `flag_active` varchar(50) NOT NULL COMMENT '是否有效',
  PRIMARY KEY (`id`),
  KEY `wechat_template_time_site_fk` (`fk_wechat_template_site_id`),
  CONSTRAINT `wechat_template_time_site_fk` FOREIGN KEY (`fk_wechat_template_site_id`) REFERENCES `wechat_template_message_site` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `wechat_template_time_record`;
CREATE TABLE `wechat_template_time_record` (
  `id` int(9) NOT NULL AUTO_INCREMENT,
  `fk_wechat_template_time_id` varchar(32) NOT NULL COMMENT '对应时间配置',
  `operate_time` datetime NOT NULL COMMENT '操作时间',
  `early_days` varchar(5) DEFAULT NULL COMMENT '提前天数',
  `name` varchar(50) NOT NULL COMMENT '名称',
  `exception_info` varchar(255) DEFAULT NULL COMMENT '异常信息',
  `is_success` char(1) NOT NULL COMMENT '是否成功',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;

ALTER TABLE wechat_template_message_group MODIFY COLUMN data_sql text;
ALTER TABLE wechat_template_message_group MODIFY COLUMN filter_sql text;
ALTER TABLE pe_schedule_trigger CHANGE trigger_date trigger_time datetime;
UPDATE `grid_column_config` SET `ID`='4028ae31698e4ecc01698ebba9780000', `fk_action_grid_config_id`='scheduleJobTriggerManage', `name`='调度时间（只执行一次）', `dataindex`='triggerTime', `data_column`='', `search`='1', `to_add`='1', `column_can_update`='0', `list`='1', `report`='1', `type`='datetime', `dateFormat`='yyyy-MM-dd HH:mm:ss', `allow_blank`='1', `max_length`='50', `check_message`='', `check_regular`='', `text_field_parameters`=NULL, `combo_sql`='', `serial_number`='7', `flag_active`='4028809c1d625bcf011d66fd0dda0006', `flag_bak`=NULL, `user_type`=NULL, `team`='', `s_note`='', `sql_result`='', `is_html`=NULL, `default_text`='', `cascade_columns`=NULL WHERE (`ID`='4028ae31698e4ecc01698ebba9780000');
INSERT INTO `grid_basic_config` (`id`, `title`, `can_search`, `can_add`, `can_delete`, `can_update`, `can_batch_add`, `can_projections`, `first_search`, `entity_class`, `note`, `list_type`, `dc`, `flag_active`, `flag_bak`, `dateFormat`, `sqlstr`, `statistics`, `s_note`, `update_note`, `is_enum`, `countsql`, `isGroupSql`, `LIST_FUNCTION`, `FLAG_INTE_ACTIVE`, `fk_web_site_id`, `can_checked_all`, `add_mode`, `add_cmp_name`, `fk_chart_id`) VALUES ('weChatTemplateTimeManage', '微信模板定时推送', '1', NULL, NULL, NULL, NULL, '0', '0', 'com.whaty.domain.bean.WeChatTemplateTime', NULL, '0', 'WeChatTemplateTime;enumConstByFlagActive;weChatTemplateMessageSite,[weChatTemplateMessageGroup],[peWebSite];', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '0', NULL, '83356b76275211e8baa4fcaa140ebf84', '0', 'dialog', NULL, NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6eff0c550004', 'weChatTemplateTimeManage', 'id', 'id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '0', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6eff4d310005', 'weChatTemplateTimeManage', '名称', 'name', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '1', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6effe9900006', 'weChatTemplateTimeManage', '站点', 'weChatTemplateMessageSite.peWebSite.name', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '2', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f002cf90007', 'weChatTemplateTimeManage', 'peWebSite.id', 'weChatTemplateMessageSite.peWebSite.id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '3', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f00a2b10008', 'weChatTemplateTimeManage', '模板组', 'weChatTemplateMessageSite.weChatTemplateMessageGroup.name', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '4', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f01569a000b', 'weChatTemplateTimeManage', 'weChatTemplateMessageGroup.id', 'weChatTemplateMessageSite.weChatTemplateMessageGroup.id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '5', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f01aff0000c', 'weChatTemplateTimeManage', 'weChatTemplateMessageSite.id', 'weChatTemplateMessageSite.id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '6', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f027a7e000d', 'weChatTemplateTimeManage', '数据查询sql', 'dataSql', '', '1', '1', '0', '1', '1', 'textArea', 'yyyy-MM-dd', '0', '5000', '', '', NULL, '', '7', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f02c508000e', 'weChatTemplateTimeManage', '提前天数', 'earlyDays', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '8', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f030db5000f', 'weChatTemplateTimeManage', '说明', 'note', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '9', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f035bf20010', 'weChatTemplateTimeManage', '是否有效', 'enumConstByFlagActive.name', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '10', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b6ecfba016b6f0386970011', 'weChatTemplateTimeManage', 'enumConstByFlagActive.id', 'enumConstByFlagActive.id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '11', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_menu_config` (`id`, `fk_grid_id`, `flag_menu_type`, `flag_integrated_menu_type`, `text`, `show_type`, `column_type`, `must_select_row`, `select_limit`, `data_index`, `null_text`, `show_confirm`, `confirm_text`, `url`, `extra_parameters`, `waiting_msg`, `success_msg`, `error_msg`, `open_mode`, `form_config`, `user_type`, `flag_is_valid`, `serial_number`, `script`, `column_data_index`, `value`, `tips`, `extend_menu_config`) VALUES ('30326', 'weChatTemplateTimeManage', NULL, 'd54b3e85479a11e89697fcaa140ebf84', '添加', '', '', '0', '0', '', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2', '1', NULL, NULL, NULL, NULL, NULL);
INSERT INTO `grid_menu_config` (`id`, `fk_grid_id`, `flag_menu_type`, `flag_integrated_menu_type`, `text`, `show_type`, `column_type`, `must_select_row`, `select_limit`, `data_index`, `null_text`, `show_confirm`, `confirm_text`, `url`, `extra_parameters`, `waiting_msg`, `success_msg`, `error_msg`, `open_mode`, `form_config`, `user_type`, `flag_is_valid`, `serial_number`, `script`, `column_data_index`, `value`, `tips`, `extend_menu_config`) VALUES ('30327', 'weChatTemplateTimeManage', NULL, 'fc43396e479a11e89697fcaa140ebf84', '修改', '', '', '0', '0', '', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2', '2', NULL, NULL, NULL, NULL, NULL);
INSERT INTO `grid_menu_config` (`id`, `fk_grid_id`, `flag_menu_type`, `flag_integrated_menu_type`, `text`, `show_type`, `column_type`, `must_select_row`, `select_limit`, `data_index`, `null_text`, `show_confirm`, `confirm_text`, `url`, `extra_parameters`, `waiting_msg`, `success_msg`, `error_msg`, `open_mode`, `form_config`, `user_type`, `flag_is_valid`, `serial_number`, `script`, `column_data_index`, `value`, `tips`, `extend_menu_config`) VALUES ('30328', 'weChatTemplateTimeManage', NULL, '030ebfea479b11e89697fcaa140ebf84', '删除', '', '', '0', '0', '', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2', '3', NULL, NULL, NULL, NULL, NULL);
INSERT INTO `grid_menu_config` (`id`, `fk_grid_id`, `flag_menu_type`, `flag_integrated_menu_type`, `text`, `show_type`, `column_type`, `must_select_row`, `select_limit`, `data_index`, `null_text`, `show_confirm`, `confirm_text`, `url`, `extra_parameters`, `waiting_msg`, `success_msg`, `error_msg`, `open_mode`, `form_config`, `user_type`, `flag_is_valid`, `serial_number`, `script`, `column_data_index`, `value`, `tips`, `extend_menu_config`) VALUES ('30329', 'weChatTemplateTimeManage', NULL, 'f82ae75b479a11e89697fcaa140ebf84', '批量导入', '', '', '0', '0', '', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2', '4', NULL, NULL, NULL, NULL, NULL);
INSERT INTO `pe_base_category` (`id`, `name`, `code`, `router_name`, `url`, `fk_grid_id`, `flag_isvalid`, `flag_is_system`, `fk_base_category_group`) VALUES ('1107', '微信模板定时推送', '', '', '/entity/message/weChatTemplateTimeManage/abstractGrid', 'weChatTemplateTimeManage', '2', '058cfaf74df211e8aac8fcaa140ebf84', '1');
INSERT INTO `pe_base_category` (`id`, `name`, `code`, `router_name`, `url`, `fk_grid_id`, `flag_isvalid`, `flag_is_system`, `fk_base_category_group`) VALUES ('1109', '微信推送配置', 'weChat-template-time-manage', '', '', NULL, '2', '0bc108f54df211e8aac8fcaa140ebf84', '1');
INSERT INTO `pe_interface` (`id`, `name`, `url`, `method`, `flag_isvalid`) VALUES ('764', '微信模板定时推送', '/entity/message/weChatTemplateTimeManage/**', '', '2');
INSERT INTO `pe_interface` (`id`, `name`, `url`, `method`, `flag_isvalid`) VALUES ('766', '微信推送配置', '/entity/message/weChatTemplateTimeManage/timeConfig', '', '2');
INSERT INTO `pr_base_category_interface` (`id`, `fk_base_category_id`, `fk_interface_id`) VALUES ('862', '1107', '764');
INSERT INTO `pr_base_category_interface` (`id`, `fk_base_category_id`, `fk_interface_id`) VALUES ('865', '1109', '766');
INSERT INTO `pe_pri_category` (`ID`, `NAME`, `FK_PARENT_ID`, `CODE`, `PATH`, `FLAG_LEFT_MENU`, `serial_Number`, `isActive`, `LEVEL`, `fk_grid_id`, `fk_web_site_id`, `icon`, `fk_base_category_id`, `base_id`, `show_in_left_menu`) VALUES ('4028ae316b6ecfba016b6f09c9230012', '微信模板定时推送', '4028ae316976612b0169766685150006', NULL, NULL, '1', '3', '1', '4', NULL, '83356b76275211e8baa4fcaa140ebf84', NULL, '1107', '82c549e2201f48609d53c68606b14768', '1');
INSERT INTO `pe_pri_category` (`ID`, `NAME`, `FK_PARENT_ID`, `CODE`, `PATH`, `FLAG_LEFT_MENU`, `serial_Number`, `isActive`, `LEVEL`, `fk_grid_id`, `fk_web_site_id`, `icon`, `fk_base_category_id`, `base_id`, `show_in_left_menu`) VALUES ('4028ae316b72d7fe016b72e440840001', '微信推送配置', '4028ae316a0b55f9016a0b60fd6f001c', NULL, NULL, '1', '10', '1', '2', NULL, '4028ae316a09ee85016a09f4d7640000', NULL, '1109', 'dfdf76ca1b0844f9a893e72f2c22bec6', '1');
ALTER TABLE wechat_template_time ADD COLUMN flag_is_show varchar(50) NOT NULL COMMENT '是否在用户端显示';
UPDATE `grid_basic_config` SET `id`='weChatTemplateTimeManage', `title`='微信模板定时推送', `can_search`='1', `can_add`=NULL, `can_delete`=NULL, `can_update`=NULL, `can_batch_add`=NULL, `can_projections`='0', `first_search`='0', `entity_class`='com.whaty.domain.bean.WeChatTemplateTime', `note`=NULL, `list_type`='0', `dc`='WeChatTemplateTime;enumConstByFlagActive;weChatTemplateMessageSite,[weChatTemplateMessageGroup],[peWebSite];enumConstByFlagIsShow;', `flag_active`='4028809c1d625bcf011d66fd0dda0006', `flag_bak`=NULL, `dateFormat`=NULL, `sqlstr`=NULL, `statistics`=NULL, `s_note`=NULL, `update_note`=NULL, `is_enum`=NULL, `countsql`=NULL, `isGroupSql`=NULL, `LIST_FUNCTION`='0', `FLAG_INTE_ACTIVE`=NULL, `fk_web_site_id`='83356b76275211e8baa4fcaa140ebf84', `can_checked_all`='0', `add_mode`='dialog', `add_cmp_name`=NULL, `fk_chart_id`=NULL WHERE (`id`='weChatTemplateTimeManage');
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b73a074016b73b292f10000', 'weChatTemplateTimeManage', '是否在用户端显示', 'enumConstByFlagIsShow.name', '', '1', '1', '0', '1', '1', 'TextField', 'yyyy-MM-dd', '0', '50', '', '', NULL, '', '12', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `grid_column_config` (`ID`, `fk_action_grid_config_id`, `name`, `dataindex`, `data_column`, `search`, `to_add`, `column_can_update`, `list`, `report`, `type`, `dateFormat`, `allow_blank`, `max_length`, `check_message`, `check_regular`, `text_field_parameters`, `combo_sql`, `serial_number`, `flag_active`, `flag_bak`, `user_type`, `team`, `s_note`, `sql_result`, `is_html`, `default_text`, `cascade_columns`) VALUES ('4028ae316b73a074016b73b2d4630001', 'weChatTemplateTimeManage', 'enumConstByFlagIsShow.id', 'enumConstByFlagIsShow.id', '', '0', '0', '0', '0', '0', 'TextField', 'yyyy-MM-dd', '1', '50', '', '', NULL, '', '13', '4028809c1d625bcf011d66fd0dda0006', NULL, NULL, '', '', '', NULL, '', NULL);
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('5', '审核流程待审核通知', 'noticeAuditor', 'SELECT\n	concat(\'有一个新的\', ty.name, \'申请需要您审核\') as `first`,\n	ty.name as keyword1,\n	cf.name as keyword2,\n	am.true_name as keyword3,\n	date_format(cf.create_date, \'%Y-%m-%d %H:%i:%s\') as keyword4,\n	\'请尽快处理\' as remark,\n        concat(\'${basePath}/ws/weChat/sso/manager/checkFlowDetail/index?roleType=manager&canBack=false&checkFlowId=\', cf.id) as url,\n        wu.openid as openId\nFROM\n	check_flow cf\nINNER JOIN enum_const ty on ty.id = cf.flag_flow_type\nINNER JOIN pe_manager am ON am.fk_sso_user_id = cf.create_by\nINNER JOIN pe_manager m on [ids|m.fk_sso_user_id]\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = m.fk_sso_user_id\nWHERE\n	wu.openid is not null\nAND [checkFlowId|cf.id]', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	pe_manager m \nINNER JOIN wechat_user wu on wu.fk_sso_user_id = m.fk_sso_user_id\nWHERE\n	wu.openid is not null\nAND [ids|m.fk_sso_user_id]');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('6', '审核流程审核结果通知', 'noticeFlowPass', 'SELECT\n	concat(ty.name, \'类型的审批已审核，审核结果如下\') as `first`,\n	cf.name as keyword1,\n	pm.true_name as keyword2,\n	st.name as keyword3,\n	date_format(cf.complete_date, \'%Y-%m-%d %H:%i:%s\') as keyword4,\n	\'点击查看处理结果的具体说明\' as remark,\n	concat(\'${basePath}/ws/weChat/sso/manager/checkFlowDetail/index?roleType=manager&canBack=false&checkFlowId=\', cf.id) as url,\n	wu.openid as openId\nFROM\n	check_flow cf\nINNER JOIN enum_const ty on ty.id = cf.flag_flow_type\nINNER JOIN enum_const st on st.id = cf.flag_check_status\nINNER JOIN pe_manager pm ON pm.fk_sso_user_id = \'${userId}\'\nINNER JOIN pe_manager m on [ids|m.fk_sso_user_id]\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = m.fk_sso_user_id\nWHERE\n	wu.openid is not null\nAND st.code <> \'1\'\nAND [checkFlowId|cf.id]', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	pe_manager m \nINNER JOIN wechat_user wu on wu.fk_sso_user_id = m.fk_sso_user_id\nWHERE\n	wu.openid is not null\nAND [ids|m.fk_sso_user_id]');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('7', '教师授课提醒', 'notifyTeacherCourse', 'SELECT\n	concat(\'尊敬的老师，您好，有课程即将开始：\', c.name, \'（\', count(DISTINCT stu.id), \'人）\') as `first`,\n	cou.name as keyword1,\n	concat(date_format(cct.training_date, \'%Y-%m-%d\'), \' \', ct.start_time, \' - \', ct.end_time) as keyword2,\n	pp.name as keyword3,\n	\'祝您生活愉快！\' as remark,\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = cou.fk_teacher_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	tea.id', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = cou.fk_teacher_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	tea.id');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('8', '班主任上课提醒', 'notifyClassMasterCourse', 'SELECT\n	concat(\'尊敬的老师，您好，有课程即将开始：\', c.name, \'（\', count(DISTINCT stu.id), \'人）\') as `first`,\n	cou.name as keyword1,\n	concat(date_format(cct.training_date, \'%Y-%m-%d\'), \' \', ct.start_time, \' - \', ct.end_time) as keyword2,\n	pp.name as keyword3,\n	\'祝您生活愉快！\' as remark,\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	tea.id', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	tea.id');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('9', '班主任开班提醒', 'notifyClassMasterStartClass', 'SELECT\n	concat(\'尊敬的班主任，您好：\') as `first`,\n	\'${schoolName}\' as keyword1,\n	\'系统提醒\' as keyword2,\n	now() as keyword3,\n	concat(\'温馨提示您“\', c.name, \'”，于“\', date_format(c.start_time, \'%Y年%m月%d日\'), \'”开始，请提前准备好相关事宜！\') as keyword4,\n	\'祝您生活愉快！\' as remark,\n	wu.openid as openId\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|c.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	c.id,\n	tea.id', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|c.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	c.id,\n	tea.id');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('10', '班主任结业提醒', 'notifyClassMasterEndClass', 'SELECT\n	concat(\'尊敬的班主任，您好：\') as `first`,\n	\'${schoolName}\' as keyword1,\n	\'系统提醒\' as keyword2,\n	now() as keyword3,\n	concat(\'温馨提示您“\', c.name, \'”，于“\', date_format(c.end_time, \'%Y年%m月%d日\'), \'”结束，请提前准备好相关事宜！\') as keyword4,\n	\'祝您生活愉快！\' as remark,\n	wu.openid as openId\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|c.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	c.id,\n	tea.id', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[ids|c.id]\nAND [teacherIds|tea.id]\nAND wu.openid is not null\nGROUP BY\n	c.id,\n	tea.id');
INSERT INTO `wechat_template_message_group` (`id`, `name`, `code`, `data_sql`, `flag_active`, `filter_sql`) VALUES ('11', '学生上课提醒', 'notifyStudentCourse', 'SELECT\n	concat(\'亲爱的同学，您好，有课程即将开始：\') as `first`,\n	cou.name as keyword1,\n	concat(date_format(cct.training_date, \'%Y-%m-%d\'), \' \', ct.start_time, \' - \', ct.end_time) as keyword2,\n	pp.name as keyword3,\n	\'祝您生活愉快！\' as remark,\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = stu.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [studentIds|stu.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	stu.id', '4028809c1d625bcf011d66fd0dda0006', 'SELECT\n	wu.openid as openId\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = stu.fk_sso_user_id\nWHERE\n	[ids|cct.id]\nAND [studentIds|stu.id]\nAND wu.openid is not null\nGROUP BY\n	cct.id,\n	stu.id');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('5', '5', '4028ae316a09ee85016a09f4d7640000', 'Ss4ZPp6rCAP2_8kUaPOwYQGfjdrqq66YFYnvck59kFs');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('6', '6', '4028ae316a09ee85016a09f4d7640000', 'K6FRxoUjn8ZSHxgk5j5_vk_qzt0P_7viaaVg6GiIogE');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('7', '7', '4028ae316a09ee85016a09f4d7640000', 'e3jij0KdfUyI7g7IIC2ecCtIaxyrOwsxXra3sf-g_OQ');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('8', '8', '4028ae316a09ee85016a09f4d7640000', 'e3jij0KdfUyI7g7IIC2ecCtIaxyrOwsxXra3sf-g_OQ');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('9', '9', '4028ae316a09ee85016a09f4d7640000', 'Ka7969aqM48Wqi0ZKG5k1rEVkc0HJYJrqw3froxF7lM');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('10', '10', '4028ae316a09ee85016a09f4d7640000', 'Ka7969aqM48Wqi0ZKG5k1rEVkc0HJYJrqw3froxF7lM');
INSERT INTO `wechat_template_message_site` (`id`, `fk_template_group_id`, `fk_web_site_id`, `template_id`) VALUES ('11', '11', '4028ae316a09ee85016a09f4d7640000', 'e3jij0KdfUyI7g7IIC2ecCtIaxyrOwsxXra3sf-g_OQ');
INSERT INTO `wechat_template_time` (`id`, `name`, `fk_wechat_template_site_id`, `data_sql`, `early_days`, `note`, `flag_active`, `flag_is_show`) VALUES ('4028ae316b726b5d016b728365e60000', '教师授课提醒', '7', 'SELECT\n	group_concat(distinct cct.id) as ids,\n	group_concat(distinct tea.id) as teacherIds\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = cou.fk_teacher_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[earlyDays|dayofyear(cct.training_date) - dayofyear(now())]\nAND wu.openid is not null', '1', '', '4028809c1d625bcf011d66fd0dda0006', '760665d5460911e9a2c3fcaa140ebf84');
INSERT INTO `wechat_template_time` (`id`, `name`, `fk_wechat_template_site_id`, `data_sql`, `early_days`, `note`, `flag_active`, `flag_is_show`) VALUES ('4028ae316b72d7fe016b72de064a0000', '班主任上课提醒', '8', 'SELECT\n	group_concat(distinct cct.id) as ids,\n	group_concat(distinct tea.id) as teacherIds\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN pe_teacher tea ON tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[earlyDays|dayofyear(cct.training_date) - dayofyear(now())]\nAND wu.openid is not null', '1', '', '4028809c1d625bcf011d66fd0dda0006', '760665d5460911e9a2c3fcaa140ebf84');
INSERT INTO `wechat_template_time` (`id`, `name`, `fk_wechat_template_site_id`, `data_sql`, `early_days`, `note`, `flag_active`, `flag_is_show`) VALUES ('4028ae316b72d7fe016b72f03bdc0002', '班主任开班提醒', '9', 'SELECT\n	group_concat(distinct c.id) as ids,\n	group_concat(distinct tea.id) as teacherIds\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[earlyDays|dayofyear(c.start_time) - dayofyear(now())]\nAND wu.openid is not null', '1', '', '4028809c1d625bcf011d66fd0dda0006', '760665d5460911e9a2c3fcaa140ebf84');
INSERT INTO `wechat_template_time` (`id`, `name`, `fk_wechat_template_site_id`, `data_sql`, `early_days`, `note`, `flag_active`, `flag_is_show`) VALUES ('4028ae316b72d7fe016b72f216640003', '班主任结业提醒', '10', 'SELECT\n	group_concat(distinct c.id) as ids,\n	group_concat(distinct tea.id) as teacherIds\nFROM\n	pe_class c\nINNER JOIN pe_teacher tea on tea.id = c.fk_class_master_id\nINNER JOIN wechat_user wu on wu.fk_sso_user_id = tea.fk_sso_user_id\nWHERE\n	[earlyDays|dayofyear(c.end_time) - dayofyear(now())]\nAND wu.openid is not null', '1', '', '4028809c1d625bcf011d66fd0dda0006', '760665d5460911e9a2c3fcaa140ebf84');
INSERT INTO `wechat_template_time` (`id`, `name`, `fk_wechat_template_site_id`, `data_sql`, `early_days`, `note`, `flag_active`, `flag_is_show`) VALUES ('4028ae316b72d7fe016b730779810004', '学生上课提醒', '11', 'SELECT\n	group_concat(distinct cct.id) as ids,\n	group_concat(distinct stu.id) as studentIds\nFROM\n	class_course_timetable cct\nINNER JOIN course_time ct ON ct.id = cct.fk_course_time_id\nINNER JOIN class_course cc ON cc.id = cct.fk_class_course_id\nINNER JOIN pe_course cou ON cou.id = cc.fk_course_id\nINNER JOIN pe_class c ON c.id = cc.fk_class_id\nINNER JOIN pe_student stu ON stu.fk_class_id = c.id\nINNER JOIN pe_place pp ON pp.id = cct.fk_place_id\nINNER JOIN wechat_user wu ON wu.fk_sso_user_id = stu.fk_sso_user_id\nWHERE\n	[earlyDays|dayofyear(cct.training_date) - dayofyear(now())]\nAND wu.openid is not null', '1', '', '4028809c1d625bcf011d66fd0dda0006', '760665d5460911e9a2c3fcaa140ebf84');
